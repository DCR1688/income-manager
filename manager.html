<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iOS风格贷款收入计算器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display', sans-serif;
        }
        
        body {
            background: #f5f5f7;
            color: #333;
            padding: 0;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
        }
        
        .header {
            background: #ffffff;
            padding: 20px;
            text-align: center;
            border-radius: 14px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 700;
            color: #000;
            margin-bottom: 5px;
        }
        
        .header p {
            font-size: 16px;
            color: #666;
        }
        
        .card {
            background: #ffffff;
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #000;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: #007AFF;
        }
        
        .input-group {
            margin-bottom: 16px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #000;
            font-size: 16px;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 16px;
            border: 1px solid #e5e5ea;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.2s;
            background: #ffffff;
        }
        
        .input-group input:focus, .input-group select:focus {
            border-color: #007AFF;
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
        }
        
        .btn {
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            margin-bottom: 12px;
        }
        
        .btn-primary {
            background: #007AFF;
            color: white;
        }
        
        .btn-primary:active {
            background: #0056b3;
            transform: scale(0.98);
        }
        
        .btn-secondary {
            background: #34C759;
            color: white;
        }
        
        .btn-secondary:active {
            background: #2a9e48;
            transform: scale(0.98);
        }
        
        .summary {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f9f9f9;
            border-radius: 12px;
        }
        
        .summary-label {
            font-size: 16px;
            font-weight: 500;
            color: #000;
        }
        
        .summary-value {
            font-size: 18px;
            font-weight: 700;
            color: #007AFF;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .data-table th, .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e5ea;
            font-size: 14px;
            word-wrap: break-word;
            white-space: normal;
        }
        
        .data-table th {
            background: #f9f9f9;
            font-weight: 600;
            color: #000;
        }
        
        .data-table tr:last-child td {
            border-bottom: none;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #8e8e93;
            font-size: 14px;
            margin-top: auto;
        }
        
        /* iOS风格调整 */
        .ios-toggle {
            position: relative;
            display: inline-block;
            width: 51px;
            height: 31px;
        }
        
        .ios-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #e5e5ea;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 27px;
            width: 27px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #34C759;
        }
        
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        /* 响应式设计 */
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 22px;
            }
            
            .card-title {
                font-size: 17px;
            }
            
            .input-group label {
                font-size: 15px;
            }
            
            .input-group input, .input-group select {
                padding: 14px;
                font-size: 15px;
            }
            
            .btn {
                padding: 14px;
                font-size: 16px;
            }
            
            .data-table th, .data-table td {
                padding: 10px;
                font-size: 13px;
            }
        }
        
        /* 自动换行设置 */
        .auto-wrap {
            white-space: normal;
            word-wrap: break-word;
            max-width: 120px;
        }
        
        /* 滚动区域 */
        .scroll-container {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
            border-radius: 14px;
            background: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        /* 自定义滚动条 */
        .scroll-container::-webkit-scrollbar {
            width: 5px;
        }
        
        .scroll-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .scroll-container::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }
        
        .scroll-container::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>贷款收入计算器</h1>
            <p>iOS风格设计，支持数据自动换行显示</p>
        </div>
        
        <div class="card">
            <div class="card-title">
                <i class="fas fa-calculator"></i>
                <span>贷款信息</span>
            </div>
            
            <div class="input-group">
                <label for="loanAmount">贷款金额 (元)</label>
                <input type="number" id="loanAmount" placeholder="请输入贷款金额">
            </div>
            
            <div class="input-group">
                <label for="interestRate">年利率 (%)</label>
                <input type="number" id="interestRate" placeholder="请输入年利率" step="0.01">
            </div>
            
            <div class="input-group">
                <label for="loanTerm">贷款期限 (月)</label>
                <input type="number" id="loanTerm" placeholder="请输入贷款期限">
            </div>
            
            <button class="btn btn-primary" id="calculateBtn">
                <i class="fas fa-calculator"></i>
                <span>计算月供</span>
            </button>
        </div>
        
        <div class="card">
            <div class="card-title">
                <i class="fas fa-chart-pie"></i>
                <span>计算结果</span>
            </div>
            
            <div class="summary">
                <div class="summary-item">
                    <span class="summary-label">每月还款</span>
                    <span class="summary-value" id="monthlyPayment">0.00 元</span>
                </div>
                
                <div class="summary-item">
                    <span class="summary-label">总利息</span>
                    <span class="summary-value" id="totalInterest">0.00 元</span>
                </div>
                
                <div class="summary-item">
                    <span class="summary-label">总还款额</span>
                    <span class="summary-value" id="totalPayment">0.00 元</span>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">
                <i class="fas fa-history"></i>
                <span>历史记录</span>
            </div>
            
            <button class="btn btn-secondary" id="saveBtn">
                <i class="fas fa-save"></i>
                <span>保存当前计算</span>
            </button>
            
            <div class="scroll-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>金额</th>
                            <th>利率</th>
                            <th>期限</th>
                            <th>月供</th>
                        </tr>
                    </thead>
                    <tbody id="historyTable">
                        <!-- 数据行将通过JavaScript动态添加 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>© 2023 iOS风格贷款计算器 | 支持自动换行显示</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loanAmountInput = document.getElementById('loanAmount');
            const interestRateInput = document.getElementById('interestRate');
            const loanTermInput = document.getElementById('loanTerm');
            const calculateBtn = document.getElementById('calculateBtn');
            const monthlyPaymentElement = document.getElementById('monthlyPayment');
            const totalInterestElement = document.getElementById('totalInterest');
            const totalPaymentElement = document.getElementById('totalPayment');
            const saveBtn = document.getElementById('saveBtn');
            const historyTable = document.getElementById('historyTable');
            
            // 从本地存储加载历史数据
            loadHistoryData();
            
            // 计算月供
            function calculateMonthlyPayment() {
                const loanAmount = parseFloat(loanAmountInput.value);
                const interestRate = parseFloat(interestRateInput.value) / 100 / 12; // 月利率
                const loanTerm = parseInt(loanTermInput.value);
                
                if (isNaN(loanAmount) || isNaN(interestRate) || isNaN(loanTerm) || 
                    loanAmount <= 0 || interestRate <= 0 || loanTerm <= 0) {
                    alert('请输入有效的贷款信息！');
                    return;
                }
                
                // 计算月供
                const x = Math.pow(1 + interestRate, loanTerm);
                const monthlyPayment = (loanAmount * x * interestRate) / (x - 1);
                
                // 计算总还款额和总利息
                const totalPayment = monthlyPayment * loanTerm;
                const totalInterest = totalPayment - loanAmount;
                
                // 更新UI
                monthlyPaymentElement.textContent = monthlyPayment.toFixed(2) + ' 元';
                totalInterestElement.textContent = totalInterest.toFixed(2) + ' 元';
                totalPaymentElement.textContent = totalPayment.toFixed(2) + ' 元';
            }
            
            // 保存当前计算到历史记录
            function saveToHistory() {
                const loanAmount = parseFloat(loanAmountInput.value);
                const interestRate = parseFloat(interestRateInput.value);
                const loanTerm = parseInt(loanTermInput.value);
                const monthlyPayment = parseFloat(monthlyPaymentElement.textContent);
                
                if (isNaN(loanAmount) || isNaN(interestRate) || isNaN(loanTerm) || isNaN(monthlyPayment)) {
                    alert('没有有效的计算结果可保存！');
                    return;
                }
                
                // 创建新行
                const newRow = document.createElement('tr');
                
                // 添加自动换行类
                newRow.innerHTML = `
                    <td class="auto-wrap">${loanAmount.toFixed(2)} 元</td>
                    <td class="auto-wrap">${interestRate.toFixed(2)}%</td>
                    <td class="auto-wrap">${loanTerm} 个月</td>
                    <td class="auto-wrap">${monthlyPayment.toFixed(2)} 元</td>
                `;
                
                // 添加到表格
                historyTable.appendChild(newRow);
                
                // 保存到本地存储
                saveHistoryData();
                
                // 显示成功消息
                alert('计算结果已保存到历史记录！');
            }
            
            // 保存历史数据到本地存储
            function saveHistoryData() {
                const rows = [];
                const tableRows = historyTable.querySelectorAll('tr');
                
                tableRows.forEach(row => {
                    rows.push({
                        amount: row.cells[0].textContent,
                        rate: row.cells[1].textContent,
                        term: row.cells[2].textContent,
                        payment: row.cells[3].textContent
                    });
                });
                
                localStorage.setItem('loanHistory', JSON.stringify(rows));
            }
            
            // 从本地存储加载历史数据
            function loadHistoryData() {
                const savedData = localStorage.getItem('loanHistory');
                
                if (savedData) {
                    try {
                        const rows = JSON.parse(savedData);
                        
                        rows.forEach(row => {
                            const newRow = document.createElement('tr');
                            newRow.innerHTML = `
                                <td class="auto-wrap">${row.amount}</td>
                                <td class="auto-wrap">${row.rate}</td>
                                <td class="auto-wrap">${row.term}</td>
                                <td class="auto-wrap">${row.payment}</td>
                            `;
                            
                            historyTable.appendChild(newRow);
                        });
                    } catch (e) {
                        console.error('加载历史数据失败:', e);
                    }
                }
            }
            
            // 添加事件监听器
            calculateBtn.addEventListener('click', calculateMonthlyPayment);
            saveBtn.addEventListener('click', saveToHistory);
            
            // 添加输入框回车键支持
            const inputs = [loanAmountInput, interestRateInput, loanTermInput];
            inputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        calculateMonthlyPayment();
                    }
                });
            });
        });
    </script>
</body>
</html>